---
tags: [lesson, recursion, algorithm, programming, aetherviz]
date: 2026-02-26
designer: training-design-agent
---

# 递归算法可视化教学 - 斐波那契数列

## 📋 课件信息

| 项目 | 内容 |
|------|------|
| **主题** | 递归算法 - 斐波那契数列 |
| **学科** | 编程/计算机科学 |
| **难度** | 中级 |
| **预计时长** | 15-20分钟 |
| **渲染模式** | SVG 2D + 动画 |
| **配色主题** | 橙色渐变 (编程学科) |

---

## 🎯 学习目标

- [ ] 理解递归的基本概念（函数调用自身）
- [ ] 掌握递归三要素：终止条件、递归关系、返回值
- [ ] 观察斐波那契数列的递归调用树结构
- [ ] 理解递归的效率问题（重复计算）
- [ ] 了解递归优化方法（记忆化）

---

## 📖 原理解释

### 什么是递归？

递归就是**函数调用自身**的编程技巧。就像俄罗斯套娃，每个娃娃里面都藏着更小的自己。

### 生活中的递归

- 🪞 两面镜子相对：无限反射
- 🌲 树枝的分叉：每个树枝都像整棵树
- 🌀 螺旋楼梯：每一层都是上一层的缩影

### 斐波那契数列

```
F(0) = 0
F(1) = 1
F(n) = F(n-1) + F(n-2)  (n ≥ 2)

数列: 0, 1, 1, 2, 3, 5, 8, 13, 21, 34...
```

**神奇之处**: 每一项都是前两项之和！

---

## 🧮 数学公式

### 递归定义

$$F(n) = \begin{cases} 
0 & \text{if } n = 0 \\
1 & \text{if } n = 1 \\
F(n-1) + F(n-2) & \text{if } n \geq 2
\end{cases}$$

### 黄金比例

当 $n \to \infty$ 时：

$$\frac{F(n+1)}{F(n)} \to \phi \approx 1.618$$

---

## 🎬 可视化设计

### 场景1: 递归调用树

```
                    F(5)
                   /    \
                F(4)    F(3)
               /    \   /    \
            F(3)   F(2) F(2) F(1)
           /    \   /\   /\
        F(2)   F(1) ...
        /\
      F(1) F(0)
```

**动画效果**:
- 节点逐个高亮显示调用顺序
- 线条流动表示数据传递
- 叶子节点（F(0), F(1)）闪烁表示终止条件
- 数值从底部向上汇聚计算

### 场景2: 调用栈演示

```
栈帧变化过程:

第1步: [F(5)]
第2步: [F(4), F(5)]
第3步: [F(3), F(4), F(5)]
...
第n步: [F(1), F(2), ...]  开始返回
```

**动画效果**:
- 栈帧压入/弹出动画
- 显示当前计算状态
- 高亮正在执行的函数

### 场景3: 重复计算警示

```
F(5) 的计算过程中:
- F(2) 被计算了 3 次！
- F(3) 被计算了 2 次！
```

**动画效果**:
- 相同节点闪烁警告
- 显示重复计算次数
- 引出优化必要性

---

## 🎮 交互控制

### 参数设置
- **n值滑块**: 1-10 (控制计算项数)
- **播放速度**: 0.5x - 2x
- **显示模式**: 调用树 / 调用栈 / 对比模式

### 操作按钮
- ▶️ **播放**: 自动演示完整递归过程
- ⏸️ **暂停**: 暂停在当前步骤
- ⏭️ **单步**: 逐步执行，适合讲解
- 🔄 **重置**: 重新开始
- 💡 **优化**: 切换显示记忆化版本

### 实时数据显示
- 当前计算的 F(n) 值
- 已执行的调用次数
- 递归深度
- 计算耗时（模拟）

---

## ❓ 小测验

### 基础题
1. 递归必须有什么条件才能停止？
   - A. 循环计数器
   - B. 终止条件 (基线条件) ✅
   - C. 全局变量
   - D. 随机数

2. 计算 F(6) 需要调用 F(2) 几次？
   - A. 2次
   - B. 3次
   - C. 4次 ✅
   - D. 5次

### 思考题
3. 如何避免重复计算？
   ```
   提示: 记忆化 / 缓存已计算结果
   ```

4. 递归和循环各有什么优缺点？
   ```
   递归: 代码简洁, 符合数学定义, 但开销大
   循环: 效率高, 但代码可能复杂
   ```

---

## 💻 代码示例

### 基础递归版本
```python
def fibonacci(n):
    if n <= 1:
        return n
    return fibonacci(n-1) + fibonacci(n-2)
```

### 记忆化优化版本
```python
memo = {}
def fibonacci_memo(n):
    if n in memo:
        return memo[n]
    if n <= 1:
        return n
    memo[n] = fibonacci_memo(n-1) + fibonacci_memo(n-2)
    return memo[n]
```

### 动画伪代码
```
函数 可视化F(n):
    创建节点(n)
    高亮显示节点(n)
    暂停(500ms)
    
    如果 n <= 1:
        标记为叶子节点
        返回值 n
    
    左子树 = 可视化F(n-1)
    右子树 = 可视化F(n-2)
    
    连接线(节点, 左子树)
    连接线(节点, 右子树)
    
    结果 = 左子树值 + 右子树值
    在节点上显示结果
    
    返回结果
```

---

## 🎨 AetherViz 生成配置

```json
{
  "theme": "programming",
  "title": "递归算法 - 斐波那契数列",
  "render_mode": "svg",
  "visualization": {
    "type": "tree_diagram",
    "animation": "step_by_step",
    "interactions": ["slider", "play_control", "highlight"]
  },
  "components": {
    "learning_objectives": true,
    "principle_explanation": true,
    "math_formulas": true,
    "code_example": true,
    "interactive_demo": true,
    "quiz_panel": true
  },
  "controls": {
    "parameter_slider": {
      "name": "n",
      "min": 1,
      "max": 10,
      "default": 5
    },
    "speed_control": true,
    "step_mode": true,
    "reset_button": true
  },
  "colors": {
    "primary": "#ff9800",
    "secondary": "#ffab40",
    "background": "linear-gradient(135deg, #e65100 0%, #ff9800 100%)",
    "node_active": "#ffd54f",
    "node_visited": "#81c784",
    "line_default": "rgba(255,255,255,0.3)",
    "line_active": "#ffd54f"
  }
}
```

---

## 📊 教学流程建议

### 第1阶段: 引入 (3分钟)
1. 展示学习目标
2. 用"套娃"比喻引入递归概念
3. 提出斐波那契数列问题

### 第2阶段: 探索 (7分钟)
1. 播放完整动画，观察调用树
2. 单步模式讲解每个调用
3. 强调终止条件的重要性

### 第3阶段: 深入 (5分钟)
1. 展示调用栈变化
2. 指出重复计算问题
3. 引入记忆化优化概念

### 第4阶段: 巩固 (5分钟)
1. 学生动手调整n值观察变化
2. 完成小测验
3. 总结递归三要素

---

## 🔗 扩展资源

- **黄金比例**: https://en.wikipedia.org/wiki/Golden_ratio
- **递归算法**: https://en.wikipedia.org/wiki/Recursion_(computer_science)
- **斐波那契数列**: https://en.wikipedia.org/wiki/Fibonacci_number
- **尾递归优化**: 进阶话题

---

## 📝 教师备注

### 常见学生问题
1. **Q**: 为什么叫"递归"而不是"循环"？
   **A**: 递归是自顶向下分解问题，循环是迭代执行

2. **Q**: 递归会栈溢出吗？
   **A**: 会！当递归深度太大时（Python默认1000层）

3. **Q**: 所有递归都能改成循环吗？
   **A**: 理论上可以，但有些问题递归表达更自然

### 重点强调
- ⚠️ 一定要有终止条件！
- ⚠️ 注意重复计算问题
- ✅ 递归适合树形结构问题

---

*课件设计: training-design-agent*  
*工具: AetherViz Master v5.0*  
*生成时间: 2026-02-26*  
*预计文件大小: ~150KB (独立HTML)*
